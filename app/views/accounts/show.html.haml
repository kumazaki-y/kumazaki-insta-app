.container
  .profile-header
    = link_to 'Back', :back, class: 'btn btn-default'
    - unless current_user == @user
      %button.follow-btn{ data: { user_id: @user.id, relationship_status: current_user.following?(@user) ? 'unfollow' : 'follow' } }
        = current_user.following?(@user) ? 'Unfollow' : 'Follow'
  .profile-info
    %p= @user.username
  - if @user.profile.avatar.attached?
    = image_tag @user.profile.avatar, class: 'profile-avatar'
  - else
    = image_tag 'default-avatar.png', class: 'profile-avatar', alt: 'デフォルトのプロフィール画像'

  %input#avatarInput{ type: "file", name: "avatar" }

  .profile-stats
    .stat-item
      %div= @user.articles.count
      %p Posts
    .stat-item
      = link_to account_followers_path(@user), class: 'follower-link' do
        %div#follower-count= @user.follower.count
        %p Followers
    .stat-item
      = link_to account_followings_path(@user), class: 'following-link' do
        %div= @user.following.count
        %p following

  .posts-timeline
    - @user.articles.order(created_at: :desc).each do |article|
      .article-image-container
        - case article.images.count
        - when 0
          = image_tag 'default-image.png', class: 'single-image article-image', alt: 'デフォルト画像'
        - when 1
          = image_tag article.images.first, class: 'single-image article-image'
        - when 2
          = image_tag article.images.first, class: 'main-image article-image'
          = image_tag article.images.second, class: 'double-image article-image'
        - else
          = image_tag article.images.first, class: 'main-image article-image'
          .side-images
            - article.images[1..2].each do |image|
              = image_tag image, class: 'side-image article-image'

